[gd_scene load_steps=17 format=3 uid="uid://bxf3h3pu0htoa"]

[ext_resource type="Script" uid="uid://b3xar2qf4p0lq" path="res://fishing_minigames/fishing_system.gd" id="1_h4yvn"]
[ext_resource type="Script" uid="uid://c3vfowirpsvnq" path="res://fishing_minigames/state_machine/state_machine.gd" id="2_k1ehf"]
[ext_resource type="Script" uid="uid://bicm5muuxnb17" path="res://fishing_minigames/casting/casting_state.gd" id="3_bb444"]
[ext_resource type="Script" uid="uid://hnxhfijc1jlc" path="res://fishing_minigames/reeling/reeling_state.gd" id="4_xi2u0"]
[ext_resource type="Script" uid="uid://dih6brdi1cxgx" path="res://fishing_minigames/hooked/hooked_state.gd" id="5_n2vtn"]
[ext_resource type="Script" uid="uid://cs5x5bdp4wcay" path="res://fishing_minigames/landing/landing_state.gd" id="6_d7i3u"]
[ext_resource type="Texture2D" uid="uid://lb3cu5ct5785" path="res://ui/circle.png" id="6_k1ehf"]
[ext_resource type="Script" uid="uid://bf34x2658hkaw" path="res://fishing_minigames/success/success_state.gd" id="7_psf8l"]
[ext_resource type="Script" uid="uid://bg2lgea76t3m8" path="res://fishing_minigames/failure/failure_state.gd" id="8_bf2fl"]
[ext_resource type="Script" uid="uid://chb1lnqbbmik0" path="res://fishing_minigames/countdown_prompt.gd" id="10_bb444"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_h4yvn"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_h4yvn"]
albedo_color = Color(0.5788026, 0, 0.29113695, 1)

[sub_resource type="CylinderShape3D" id="CylinderShape3D_k1ehf"]

[sub_resource type="Animation" id="Animation_h4yvn"]
resource_name = "bob"
length = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("CSGCylinder3D:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.000512464, 0.06666667, 0.16666667),
"transitions": PackedFloat32Array(1, 1, 0.33440053, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(0, 0, 0), Vector3(0, -1, 0), Vector3(0, 0, 0)]
}

[sub_resource type="Animation" id="Animation_k1ehf"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("CSGCylinder3D:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_bb444"]
_data = {
&"RESET": SubResource("Animation_k1ehf"),
&"bob": SubResource("Animation_h4yvn")
}

[node name="FishingSystem" type="Node"]
script = ExtResource("1_h4yvn")

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("initial_state")]
unique_name_in_owner = true
script = ExtResource("2_k1ehf")
initial_state = NodePath("Casting")
metadata/_custom_type_script = "uid://c3vfowirpsvnq"

[node name="Casting" type="Node" parent="StateMachine" node_paths=PackedStringArray("reeling_state")]
script = ExtResource("3_bb444")
reeling_state = NodePath("../Reeling")

[node name="Reeling" type="Node" parent="StateMachine" node_paths=PackedStringArray("casting_state", "hooked_state")]
script = ExtResource("4_xi2u0")
casting_state = NodePath("../Casting")
hooked_state = NodePath("../Hooked")
metadata/_custom_type_script = "uid://lk6olkx3g1ca"

[node name="Hooked" type="Node" parent="StateMachine" node_paths=PackedStringArray("landing_state", "failure_state")]
script = ExtResource("5_n2vtn")
landing_state = NodePath("../Landing")
failure_state = NodePath("../Failure")
metadata/_custom_type_script = "uid://lk6olkx3g1ca"

[node name="Landing" type="Node" parent="StateMachine" node_paths=PackedStringArray("success_state", "failure_state")]
script = ExtResource("6_d7i3u")
success_state = NodePath("../Success")
failure_state = NodePath("../Failure")
metadata/_custom_type_script = "uid://lk6olkx3g1ca"

[node name="Success" type="Node" parent="StateMachine" node_paths=PackedStringArray("casting_state")]
script = ExtResource("7_psf8l")
casting_state = NodePath("../Casting")
metadata/_custom_type_script = "uid://lk6olkx3g1ca"

[node name="Failure" type="Node" parent="StateMachine" node_paths=PackedStringArray("casting_state")]
script = ExtResource("8_bf2fl")
casting_state = NodePath("../Casting")
metadata/_custom_type_script = "uid://lk6olkx3g1ca"

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="CountdownPrompt" type="TextureProgressBar" parent="CanvasLayer"]
unique_name_in_owner = true
visible = false
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -8.0
offset_top = -8.0
offset_right = 8.0
offset_bottom = 8.0
grow_horizontal = 2
grow_vertical = 2
scale = Vector2(4, 4)
max_value = 1.0
step = 0.01
value = 1.0
fill_mode = 4
texture_progress = ExtResource("6_k1ehf")
script = ExtResource("10_bb444")

[node name="RichTextLabel" type="RichTextLabel" parent="CanvasLayer/CountdownPrompt"]
unique_name_in_owner = true
visible = false
layout_mode = 1
anchors_preset = -1
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 48.0
offset_bottom = 48.0
grow_horizontal = 2
grow_vertical = 2
scale = Vector2(0.25, 0.25)
theme_override_colors/default_color = Color(1, 1, 1, 1)
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 4
theme_override_font_sizes/normal_font_size = 16
fit_content = true
horizontal_alignment = 1
vertical_alignment = 1
metadata/_edit_use_anchors_ = true

[node name="CastDistance" type="ProgressBar" parent="CanvasLayer"]
unique_name_in_owner = true
visible = false
anchors_preset = 14
anchor_top = 0.5
anchor_right = 1.0
anchor_bottom = 0.5
offset_top = -168.0
offset_bottom = -141.0
grow_horizontal = 2
grow_vertical = 2
step = 0.1
show_percentage = false

[node name="CastAccuracy" type="ProgressBar" parent="CanvasLayer"]
unique_name_in_owner = true
visible = false
anchors_preset = 14
anchor_top = 0.5
anchor_right = 1.0
anchor_bottom = 0.5
offset_top = 24.0
offset_bottom = 51.0
grow_horizontal = 2
grow_vertical = 2
step = 0.1
show_percentage = false

[node name="BobberTest" type="CharacterBody3D" parent="."]
unique_name_in_owner = true
visible = false
collision_mask = 0

[node name="CollisionShape3D" type="CollisionShape3D" parent="BobberTest"]
shape = SubResource("CylinderShape3D_h4yvn")

[node name="CSGCylinder3D" type="CSGCylinder3D" parent="BobberTest"]
material = SubResource("StandardMaterial3D_h4yvn")

[node name="FishDetector" type="Area3D" parent="BobberTest"]
collision_layer = 0
collision_mask = 2
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="BobberTest/FishDetector"]
shape = SubResource("CylinderShape3D_k1ehf")

[node name="AnimationPlayer" type="AnimationPlayer" parent="BobberTest"]
unique_name_in_owner = true
libraries = {
&"": SubResource("AnimationLibrary_bb444")
}

[connection signal="add_camera_shake" from="StateMachine/Reeling" to="." method="_on_add_camera_shake"]
[connection signal="add_camera_shake" from="StateMachine/Hooked" to="." method="_on_add_camera_shake"]
[connection signal="add_camera_shake" from="StateMachine/Landing" to="." method="_on_add_camera_shake"]
[connection signal="body_entered" from="BobberTest/FishDetector" to="StateMachine/Reeling" method="_on_fish_detector_body_entered"]
[connection signal="body_exited" from="BobberTest/FishDetector" to="StateMachine/Reeling" method="_on_fish_detector_body_exited"]
